<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"> 

<div class="nav-bar">

    <div class="nav-bar-container">
        <i class="fas fa-bars icon"></i> 
        <h1>Diet Manager</h1>   
    </div>

    <div class="diet-nav-container">
            <ul>
                <li (click)="decreaseDate()">{{this.formatDate(this.prevDate)}}</li>
                <li>{{this.formatDate(this.currentDate)}}</li>
                <li (click)="increaseDate()">{{this.formatDate(this.nextDate)}}</li>
            </ul>       
    </div>
    <div class="meals-container">

      <ng-container *ngFor="let oneMeal of userDiet; let i = index">
        <ng-container *ngIf="oneMeal.mealDate == this.formatDate(this.currentDate)">
        <div class="meal-container">
          <div class="meal-info" (click)="openTable(i)">
            <span class="meal-name">
              <i class="fas fa-caret-down"></i>
              {{oneMeal.name}}
            </span>
            <ul>
              <li>{{this.Proteins(oneMeal.mealsList)}}g </li>
              <li>{{this.Fats(oneMeal.mealsList)}}g </li>
              <li>{{this.Carbs(oneMeal.mealsList)}}g </li>
              <li>{{this.Calories(oneMeal.mealsList)}} kcal</li>
            </ul>
          </div>
          <div class="meal-details">
            <ng-container  *ngFor="let object of oneMeal.mealsList; let j = index" >
              <div class="meal-product" [hidden]="tableManagment(i)">
                <span class="product-name">{{object.product.name}}</span>
                <span class="product-weight">Waga: {{object.productWeight}}g</span>
                <ul>
                  <li>{{solveMacro(object.product.fats,object.productWeight)}} g</li>
                  <li>{{solveMacro(object.product.carbs,object.productWeight)}} g</li>
                  <li>{{solveMacro(object.product.kcal,object.productWeight)}} g</li>
                  <li>{{object.productWeight}} kcal</li>
                </ul>
              </div>
            </ng-container>
          </div>
        </div>
        </ng-container>
      </ng-container>

      
    </div> 
    <button class="btn-workout" (click)="openModal('createmealmodal')">Add meal</button> 

</div>

<div class="create-meal-modal" id="createmealmodal">
  <div class="create-meal-container">
    <div class="modal-title"> 
        <h4>Create meal</h4>
        <button class="modal-close-btn" (click)="closeModal('createmealmodal')" (click)="closeAndDiscard()">
          &times;
        </button>
    </div>
    <input class="meal-name" placeholder="meal name" type="text" [(ngModel)]="object.name">
    <div class="modal-add-product">
      <span>Products</span><button (click)="openModal('addproductmodal')">Add</button>
    </div>
    <div class="meal-product" *ngFor="let item of object.mealsList">
      <span class="product-name">{{item.product.name}}</span>        
      <button class="modal-delete-product" (click)="deleteProduct(item.product.name)">
        &times;
      </button>
      <span class="product-weight">Waga: {{item.productWeight}} g</span>
      <ul>
          <li>{{item.product.proteins}} g</li>
          <li>{{item.product.carbs}} g</li>
          <li>{{item.product.fats}} g</li>
          <li>{{item.product.kcal}} kcal</li>
      </ul>
    </div>

    <div class="modal-title"> 
      <h4></h4>
      <button class="product-add-btn" (click)="closeAndSave()">
        <i class="fas fa-check"></i>
      </button>
    </div>

  </div>
</div>

<div class="create-meal-modal" id="addproductmodal">
  <div class="create-meal-container">
    <div class="modal-title"> 
      <h4>Find product</h4>
      <button class="modal-close-btn" (click)="closeModal('addproductmodal')" (click)="removeItemFromResults()">
        &times;
      </button>
    </div>

    <input id="typeahead-basic"class="meal-name" 
    placeholder="product name" type="text" 
    [(ngModel)]="model" [ngbTypeahead]="search" (selectItem)="selectItemFromResults($event)"/>

  <div class="meal-product" *ngIf="product != null ">
    <span class="product-name">{{product.name}}</span>        
    <button class="modal-delete-product" (click)="removeItemFromResults()">
      &times;
    </button>
    <ul>
      <li>{{product.proteins}} g</li>
      <li>{{product.carbs}} g</li>
      <li>{{product.fats}} g</li>
      <li>{{product.kcal}} kcal</li>
    </ul>
    <form class="insert-product-weight">
      <label>Weight</label>
      <input name="productWeight" class="product-weight" placeholder="product weight grams" type="text" [(ngModel)]="productWeightInMeal">
    </form>
    </div>
    <div class="modal-title"> 
      <h4></h4>
      <button class="product-add-btn" (click)="addProductToMeal()">
        <i class="fas fa-check"></i>
      </button>
    </div>

  </div>
</div>


